<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate a Phylogenetic Network to a Specified Number of Taxa — sim.bdh.taxa.ssa • SiPhyNetwork</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a Phylogenetic Network to a Specified Number of Taxa — sim.bdh.taxa.ssa"><meta property="og:description" content="Simulates a Phylogenetic Network under a birth-death-hybridization model. Simulates to a specified number of extant tips under the Simple Sampling Approach."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SiPhyNetwork</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate a Phylogenetic Network to a Specified Number of Taxa</h1>
    
    <div class="hidden name"><code>sim.bdh.taxa.ssa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates a Phylogenetic Network under a birth-death-hybridization model. Simulates to a specified number of extant tips under the Simple Sampling Approach.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim.bdh.taxa.ssa</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">numbsim</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">mu</span>,</span>
<span>  <span class="va">nu</span>,</span>
<span>  <span class="va">hybprops</span>,</span>
<span>  <span class="va">hyb.inher.fxn</span>,</span>
<span>  frac <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  twolineages <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  complete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stochsampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hyb.rate.fxn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trait.model <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>n</dt>
<dd><p>The number of taxa.</p></dd>


<dt>numbsim</dt>
<dd><p>Number of networks to simulate.</p></dd>


<dt>lambda</dt>
<dd><p>Speciation rate.</p></dd>


<dt>mu</dt>
<dd><p>Extinction rate.</p></dd>


<dt>nu</dt>
<dd><p>Hybridization rate.</p></dd>


<dt>hybprops</dt>
<dd><p>Vector that represents the proportion of Hybridizations that are lineage generative, lineage degenerative, and lineage neutral respectively.</p></dd>


<dt>hyb.inher.fxn</dt>
<dd><p>A function for drawing the hybrid inheritance probabilities.</p></dd>


<dt>frac</dt>
<dd><p>Sampling fraction: The proportion of extant tips included in the phylogeny (incomplete sampling).</p></dd>


<dt>twolineages</dt>
<dd><p>If <code>twolineages=TRUE</code>: The process originates with two lineages that share a common ancestor. If <code>twolineages=FALSE</code>: The process originates with two lineages.</p></dd>


<dt>complete</dt>
<dd><p>If complete = TRUE, the tree with the extinct lineages is returned. If complete = FALSE, the extinct lineages are suppressed.</p></dd>


<dt>stochsampling</dt>
<dd><p>When <code>stochsampling=TRUE</code>: Each extant tip is included into the final tree with probability frac.</p></dd>


<dt>hyb.rate.fxn</dt>
<dd><p>The probability of a successful hybridization as a function of genetic distance between taxa. The default value of `NULL`` assumes that hybridization success is independent of genetic distance between taxa.</p></dd>


<dt>trait.model</dt>
<dd><p>A list that dictates how a trait affects the hybridization process. The default value of <code>NULL</code> doesn't take a trait into account for simulation. See Details for more information.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>out Returns a list of numbsim networks with the time since origin / most recent common ancestor being 'age.' If tree goes extinct or no tips are sampled, return value is '0'. If only one extant and no extinct tips are sampled, return value is '1'. Each network has an additional attribute "inheritance" that represents the inheritance probabilities on the edges in the "reticulation" attribute.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>hyb.inher.fxn</code> should return values between 0 and 1 and shouldn't require any arguments. E.g. <a href="make.beta.draw.html">make.beta.draw</a> and <a href="make.uniform.draw.html">make.uniform.draw</a> create functions that fit these specifications</p>
<p><code>hyb.rate.fxn</code> should take one argument for the genetic distance. The function should be defined on the range \([0,Inf)\) and return values between \([0,1]\)</p>
<p><code>trait.model</code> is a list with the following named elements:</p><ul><li><p><code>initial</code> The initial trait state on the phylogeny</p></li>
<li><p><code>hyb.event.fxn</code> A function that denotes the trait of a hybrid child after a hybridization event. The function should have the arguments <code>parent_states</code> and <code>inheritance</code>. <code>parent_states</code> is vector with the ploidy states of the hybrid parents while <code>inheritance</code> is the inheritance probability of the first lineage denoted in <code>parent_states</code>.</p></li>
<li><p><code>hyb.compatibility.fxn</code> A function that describes when hybridization events can occur between two taxa based on their traits. The function should have the argument <code>parent_states</code>, a vector with the trait states of the two parents to the hybrid child. The function should return <code>TRUE</code> for when a hybridization event is allowed to proceed and <code>FALSE</code> otherwise.</p></li>
<li><p><code>time.fxn</code> A function that describes how traits change over time. The function should have the arguments <code>trait_states</code> and <code>timestep</code> in that order. <code>trait_states</code> is a vector containing the ploidy of all taxa while <code>timestep</code> is the amount of time given for trait evolution. The function should return a vector with the updated ploidy states of all taxa.</p></li>
<li><p><code>spec.fxn</code> A function that describes how the trait changes at speciation events.The function should have the argument <code>tip_state</code> which has the state of the lineage just before speciation. The function should return a vector with two values, one denoting the trait of each of the two new species after the event.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">##Generate a tree with extinct leaves</span></span></span>
<span class="r-in"><span><span class="va">net</span><span class="op">&lt;-</span><span class="fu">sim.bdh.taxa.ssa</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">1.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>hyb.inher.fxn <span class="op">=</span> <span class="fu"><a href="make.uniform.draw.html">make.uniform.draw</a></span><span class="op">(</span><span class="op">)</span>,complete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joshua Justison, Claudia Solis-Lemus, Tracy A. Heath.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

